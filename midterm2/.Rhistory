library("naniar")
surgery <- read_csv("data/surgery.csv")
surgery %>%
ggplot(aes(x=ahrq_ccs, y=ccsmort30rate, group=ahrq_ccs))+
geom_col(position="dodge", fill="steelblue", alpha=0.6)+
coord_flip()+
labs(title="30-Day Mortality by Procedure",
x=NULL,
y="Rate")+
theme_light()
surgery_new <- surgery %>%
mutate(mort30_n = ifelse(mort30 == "Yes", 1, 0),
complication_n = ifelse(complication =="Yes", 1, 0)) %>%
group_by(month) %>%
summarise(n_deaths=sum(mort30_n),
n_comp=sum(complication_n))
surgery_new
View(surgery)
sharks %>%
mutate(fatal_n = ifelse(mort30 == "fatal", 1, 0)) %>%
select(county, injury) %>%
group_by(county) %>%
filter(injury=="fatal") %>%
sharks %>%
mutate(fatal_n = ifelse(mort30 == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
filter(injury=="fatal") %>%
sharks %>%
mutate(fatal_n = ifelse(mort30 == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
sharks %>%
mutate(fatal_n = ifelse(mort30 == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county)
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county)
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
arrange(desc(fatal_n))
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
arrange(desc(fatal_n)) %>%
slice_max(fatal_n, n=1)
surgery %>%
group_by(ahrq_ccs) %>%
summarise(ccsmort30rate=mean(ccsmort30rate)) %>%
arrange(desc(ccsmort30rate)) %>%
slice_max(ccsmort30rate, n=5)
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
arrange(desc(fatal_n))
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
arrange(desc(fatal_n))
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county)
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
slice_max(county, n=5)
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
select(county, fatal_n) %>%
group_by(county) %>%
summarize(n_county=n_distinct(county))
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
count(county, fatal_n)
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
count(county, fatal_n) %>%
arrange(desc(fatal_n))
sharks %>%
mutate(fatal_n = ifelse(injury == "fatal", 1, 0)) %>%
count(county, fatal_n, sort=T)
sharks %>%
select(incident_num, mode) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.8, fill="yellow3", color="black") +
labs(title="Activity Done During Incident",
x="Mode",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
sharks %>%
select(incident_num, mode) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.8, fill="tan", color="black") +
labs(title="Activity Done During Incident",
x="Mode",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
homerange %>%
select(incident_num, mode) %>%
ggplot(aes(x=mode))+
geom_bar()+
facet_wrap(~injury)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks %>%
select(incident_num, mode) %>%
ggplot(aes(x=mode))+
geom_bar()+
facet_wrap(~injury)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=mode))+
geom_bar()+
facet_wrap(~injury)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.5, fill="red3", color="black") +
labs(title="Activity Done During Incident and Injury",
x="Mode",
y="Number of Incidents")+)+
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.5, fill="red3", color="black") +
labs(title="Activity Done During Incident and Injury",
x="Mode",
y="Number of Incidents")+
facet_wrap(~injury)+
theme(axis.text.x = element_text(angle = 60, hjust=1))+
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.5, fill="red3", color="black") +
labs(title="Activity Done During Incident and Injury",
x="Mode",
y="Number of Incidents")+
facet_wrap(~injury)+
theme(axis.text.x = element_text(angle = 60, hjust=1))+
theme_light()
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.5, fill="red3", color="black") +
labs(title="Activity Done During Incident and Injury",
x="Mode",
y="Number of Incidents")+
facet_wrap(~injury)+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=mode))+
geom_bar(alpha=0.5, fill="red3", color="black") +
labs(title="Activity Done During Incident and Injury",
x="Mode",
y="Number of Incidents")+
facet_wrap(~injury)+
theme(plot.title=element_text(size=rel(1.25), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
white_sharks %>%
select(sex, total_length_cm) %>%
filter(sex!="NA") %>%
ggplot(aes(x=sex, y=total_length_cm, fill=sex))+
geom_boxplot(color="black") +
labs(title="Average Length vs Sex",
x="Sex",
y="Total Length (cm)")+
theme(plot.title=element_text(size=rel(2), hjust = 0.5))+
theme_light()
View(white_sharks)
#What location has the most incidents per year?
sharks %>%
count(location)
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year"))
count(location)
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
count(location)
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
count(location) %>%
ggplot(x=year, y=location, fill=n)
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
count(location) %>%
ggplot(x=year, y=location, fill=n) +
geom_jitter()
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
count(location) %>%
ggplot(x=n, y=location, fill=year) +
geom_jitter()
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
count(location) %>%
ggplot(x=n, y=location, color=year) +
geom_jitter()
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
count(location) %>%
ggplot(x=loation, y=n, color=year) +
geom_jitter()
#What location has the most incidents per year?
sharks %>%
mutate(as.factor("year")) %>%
ggplot(x=loation, y=n, color=year) +
geom_jitter()
#What depth interacts with what species?
sharks %>%
ggplot(aes(x=depth, y=species))
#What depth interacts with what species?
sharks %>%
ggplot(aes(x=species, y= depth))+
geom_point()
#What depth interacts with what species?
sharks %>%
ggplot(aes(x=species, y= depth))+
geom_col()
#What location has teh most incidnts per year
sharks %>%
ggplot(aes(x=year, y= loction))+
geom_col()
#What location has the most incidents per year?
sharks %>%
ggplot(aes(x=year, y= loction))+
geom_col()
#What location has the most incidents per year?
sharks %>%
select(year, location)
ggplot(aes(x=year, y= loction))+
geom_col()
#What location has the most incidents per year?
sharks %>%
select(year, location) %>%
count(location) %>%
ggplot(aes(x=year, y= loction))+
geom_col()
#What county has the most incidents per year?
sharks %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=year, y= loction))+
geom_col()
#What county has the most incidents per year?
sharks %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=year, y= county))+
geom_col()
#What county has the most incidents per year?
sharks %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=year))+
geom_col()
#What county has the most incidents per year?
sharks %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, y=n)+
geom_col()
#What county has the most incidents per year?
sharks %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, y=n))+
geom_col()
#What county has the most incidents per year?
sharks %>%
mutate(as.factor(year)) %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, y=n))+
geom_col()
#What county has the most incidents per year?
sharks %>%
mutate(as.factor(year)) %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=year))+
geom_col()
#What county has the most incidents per year?
sharks %>%
mutate(as.factor(year)) %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, y=n))+
geom_col()
#What county has the most incidents per year?
sharks %>%
mutate(as.factor(year)) %>%
select(year, county) %>%
count(county) %>%
ggplot(aes(x=county, fill=year))+
geom_bar()
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2004") %>%
count(county)
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2004") %>%
count(county) %>%
```
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2004") %>%
count(county) %>%
top_n(5, county)
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2004") %>%
count(county) %>%
top_n(5, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lavender", color="black") +
labs(title="Incident Hotspots",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
sharks %>% count(year)
sharks %>% count(year) %>% arrange(desc(year))
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
count(county) %>%
top_n(5, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lavender", color="black") +
labs(title="Incident Hotspots",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(5, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lavender", color="black") +
labs(title="Incident Hotspots",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(5, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Incident Hotspots",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(5, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top4 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 3 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(3, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top 3 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.25), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 3 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(3, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top 3 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 3 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(4, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top 3 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 5 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(-5, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top 5 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 3 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(-3, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top 3 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
#What top 3 counties has the most incidents in 2004?
sharks %>%
select(year, county) %>%
filter(year=="2017") %>%
top_n(4, county) %>%
ggplot(aes(x=county))+
geom_bar(alpha=0.9, fill="lightyellow", color="black") +
labs(title="Top 3 Number of Incidents Per County in 2017",
x="County",
y="Number of Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
sharks %>%
tabyl(county, injury)
sharks %>% group_by(county) %>%
tabyl(county, injury)
sharks %>%
count(injury) %>%
tabyl(county, injury)
sharks %>%
count(county) %>%
tabyl(county, injury)
sharks %>%
tabyl(county, injury)
sharks %>%
filter(injury=="fatal") %>%
tabyl(county, injury)
sharks %>%
tabyl(injury, county)
sharks %>%
select(incident_num, mode, injury) %>%
ggplot(aes(x=injury))+
geom_bar(alpha=0.5, fill="red3", color="black") +
labs(title="Activity Done During Incident and Injury",
x="Type of Injury",
y="Number of Incidents")+
facet_wrap(~mode)+
theme(plot.title=element_text(size=rel(1.25), hjust = 0.5))+
theme(axis.text.x = element_text(angle = 70, hjust=1))
theme_light()
